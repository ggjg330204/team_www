# ğŸ—„ï¸ DB & Storage ì•„í‚¤í…ì²˜

## ğŸ“‹ ê°œìš”

ì´ ë¬¸ì„œëŠ” WordPress ì›Œë“œí”„ë ˆìŠ¤ ì„œë¹„ìŠ¤ì˜ **ë°ì´í„°ë² ì´ìŠ¤**ì™€ **ìŠ¤í† ë¦¬ì§€** ì¸í”„ë¼ êµ¬ì¡°ë¥¼ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## ğŸ—ï¸ ì „ì²´ êµ¬ì¡°ë„

```mermaid
graph TB
    subgraph "Primary Region (Korea Central)"
        subgraph "Application Layer"
            WEB[WordPress VM/Container]
        end
        
        subgraph "Data Layer"
            MYSQL[(MySQL Primary<br/>ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤)]
            REDIS[(Redis Cache<br/>ìºì‹œ ì„œë²„)]
            STORAGE[Storage Account<br/>íŒŒì¼ ì €ì¥ì†Œ]
            PE_DB[Private Endpoint<br/>DB ì „ìš©]
            PE_STG[Private Endpoint<br/>Storage ì „ìš©]
        end
        
        subgraph "Analytics"
            ADF[Data Factory<br/>ë°ì´í„° ë¶„ì„]
        end
    end
    
    subgraph "Secondary Region (Korea South)"
        MYSQL_REP[(MySQL Replica<br/>ë°±ì—… ë°ì´í„°ë² ì´ìŠ¤)]
    end
    
    subgraph "Global CDN"
        CDN[Azure CDN<br/>ì „ ì„¸ê³„ ë°°í¬]
    end
    
    WEB -->|ì½ê¸°/ì“°ê¸°| PE_DB
    PE_DB --> MYSQL
    WEB -->|ìºì‹œ ì¡°íšŒ| REDIS
    WEB -->|íŒŒì¼ ì—…ë¡œë“œ| PE_STG
    PE_STG --> STORAGE
    
    MYSQL -.->|ì‹¤ì‹œê°„ ë³µì œ| MYSQL_REP
    STORAGE -->|ì›ë³¸ ì œê³µ| CDN
    CDN -.->|ë¹ ë¥¸ ì „ì†¡| WEB
    
    ADF -.->|ë°ì´í„° ì¶”ì¶œ| MYSQL
    ADF -.->|íŒŒì¼ ì²˜ë¦¬| STORAGE
    
    style MYSQL fill:#ff6b6b
    style MYSQL_REP fill:#ffd93d
    style REDIS fill:#4ecdc4
    style STORAGE fill:#95e1d3
    style CDN fill:#a8dadc
    style ADF fill:#457b9d
```

---

## ğŸ’¾ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°

### MySQL Flexible Server

**ì—­í• **: WordPressì˜ ëª¨ë“  ë°ì´í„° ì €ì¥ (ê¸€, ì‚¬ìš©ì, ëŒ“ê¸€ ë“±)

**êµ¬ì„±**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Primary (Korea Central)            â”‚
â”‚  - MySQL 8.0.21                     â”‚
â”‚  - B_Standard_B2s (2vCore, 4GB)     â”‚
â”‚  - ì½ê¸°/ì“°ê¸° ì²˜ë¦¬                   â”‚
â”‚  - Private Endpoint ì—°ê²°            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ (Geo-Replication)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Replica (Korea South)              â”‚
â”‚  - ì½ê¸° ì „ìš©                        â”‚
â”‚  - ì¬í•´ ë³µêµ¬ìš©                      â”‚
â”‚  - ìë™ ë™ê¸°í™”                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì£¼ìš” íŠ¹ì§•**:
- âœ… **ìë™ ë°±ì—…**: ë§¤ì¼ ë°±ì—…, 35ì¼ ë³´ê´€
- âœ… **ì§€ì—­ ì´ì¤‘í™”**: í•œêµ­ ì¤‘ë¶€ â†’ í•œêµ­ ë‚¨ë¶€ ì‹¤ì‹œê°„ ë³µì œ
- âœ… **ë³´ì•ˆ ì ‘ì†**: Private Endpointë¡œ ì™¸ë¶€ ì°¨ë‹¨
- âœ… **ê°ì‚¬ ë¡œê·¸**: ëª¨ë“  DB ì ‘ê·¼ ê¸°ë¡ ì €ì¥

---

## ğŸ’¿ ìºì‹œ ì‹œìŠ¤í…œ

### Redis Cache

**ì—­í• **: ìì£¼ ì¡°íšŒí•˜ëŠ” ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ì— ì €ì¥í•´ì„œ DB ë¶€í•˜ ê°ì†Œ

**êµ¬ì„±**:
```
Redis Cache (Korea Central)
â”œâ”€ SKU: Basic / Standard / Premium
â”œâ”€ ìš©ëŸ‰: 250MB ~ 53GB ì„ íƒ ê°€ëŠ¥
â”œâ”€ í¬íŠ¸: 6380 (SSL ì•”í˜¸í™”)
â””â”€ ìš©ë„: ì„¸ì…˜, í˜ì´ì§€ ìºì‹±, ê°ì²´ ìºì‹±
```

**ìºì‹± ì „ëµ**:
- ğŸ”¹ WordPress í˜ì´ì§€ ìºì‹œ
- ğŸ”¹ ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ê²°ê³¼ ì €ì¥
- ğŸ”¹ ì‚¬ìš©ì ì„¸ì…˜ ì •ë³´ ì €ì¥

---

## ğŸ“¦ ìŠ¤í† ë¦¬ì§€ êµ¬ì¡°

### Storage Account

**ì—­í• **: ì´ë¯¸ì§€, ë™ì˜ìƒ, Terraform State íŒŒì¼ ì €ì¥

**ì»¨í…Œì´ë„ˆ êµ¬ì„±**:

| ì»¨í…Œì´ë„ˆëª… | ìš©ë„ | ì ‘ê·¼ ìˆ˜ì¤€ | ë¹„ê³  |
|-----------|------|----------|------|
| **media** | ì—…ë¡œë“œ íŒŒì¼ (ì´ë¯¸ì§€, ë™ì˜ìƒ) | Private | Lifecycle ì •ì±… ì ìš© |
| **tfstate** | Terraform ìƒíƒœ íŒŒì¼ | Private | ğŸ”’ ë§¤ìš° ì¤‘ìš”! |

**Lifecycle Management**:
```
ì—…ë¡œë“œëœ íŒŒì¼ ìˆ˜ëª… ì£¼ê¸°:
0ì¼ â”€â”€â”€â”€â”€â”€â”€â”€> 30ì¼ â”€â”€â”€â”€â”€â”€â”€â”€> 90ì¼ â”€â”€â”€â”€â”€â”€â”€â”€> 365ì¼
 â”‚              â”‚              â”‚              â”‚
ì €ì¥ (Hot)    Cool Tier    Archive      ìë™ ì‚­ì œ
              (ë¹„ìš© â†“)     (ë¹„ìš© â†“â†“)
```

---

## ğŸŒ CDN (Content Delivery Network)

**ì—­í• **: ì „ ì„¸ê³„ ì‚¬ìš©ìì—ê²Œ ì´ë¯¸ì§€ë¥¼ ë¹ ë¥´ê²Œ ì „ì†¡

**ì‘ë™ ë°©ì‹**:
```
ì‚¬ìš©ì (ì¼ë³¸) â”€â”€â”
ì‚¬ìš©ì (ë¯¸êµ­) â”€â”€â”¼â”€â”€> CDN Edge (ê°€ê¹Œìš´ ì„œë²„)
ì‚¬ìš©ì (ìœ ëŸ½) â”€â”€â”˜         â”‚
                          â†“ (ìµœì´ˆ 1íšŒë§Œ ê°€ì ¸ì˜´)
                   Storage Account (í•œêµ­)
```

**ì£¼ìš” íš¨ê³¼**:
- âš¡ ì´ë¯¸ì§€ ë¡œë”© ì†ë„ 3~10ë°° í–¥ìƒ
- ğŸ’° ì›ë³¸ ìŠ¤í† ë¦¬ì§€ íŠ¸ë˜í”½ ë¹„ìš© ì ˆê°
- ğŸŒ ì „ ì„¸ê³„ ì–´ë””ì„œë‚˜ ë¹ ë¥¸ ì ‘ì†

---

## ğŸ“Š ë°ì´í„° ë¶„ì„

### Data Factory

**ì—­í• **: DB ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ì—¬ ë¶„ì„ ì‘ì—… ìˆ˜í–‰

**ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤**:
- ğŸ“ˆ ì¼ë³„/ì›”ë³„ í†µê³„ ë°ì´í„° ìƒì„±
- ğŸ”„ ë°ì´í„° ë³€í™˜ ë° ê°€ê³µ
- ğŸ“¤ ì™¸ë¶€ ì‹œìŠ¤í…œìœ¼ë¡œ ë°ì´í„° ì „ì†¡

---

## ğŸ”’ ë³´ì•ˆ êµ¬ì¡°

### Private Endpoint

ëª¨ë“  ë°ì´í„° ë¦¬ì†ŒìŠ¤ëŠ” **Private Endpoint**ë¥¼ í†µí•´ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥:

```
ì™¸ë¶€ ì¸í„°ë„· (Public)
         â†“ âŒ ì°¨ë‹¨
    [ ë°©í™”ë²½ ]
         â†“ âœ… í—ˆìš©
   VNet (ì‚¬ì„¤ë§)
         â†“
Private Endpoint
         â†“
   DB / Storage
```

**ë³´ì•ˆ íŠ¹ì§•**:
- ğŸ›¡ï¸ Public IP ì—†ìŒ (ì™¸ë¶€ ì ‘ê·¼ ë¶ˆê°€)
- ğŸ” VNet ë‚´ë¶€ì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥
- ğŸ“ ëª¨ë“  ì ‘ê·¼ ê¸°ë¡ ê°ì‚¬ ë¡œê·¸ì— ì €ì¥

---

## ğŸ“ˆ ë°ì´í„° íë¦„

### 1ï¸âƒ£ ì‚¬ìš©ìê°€ ê¸€ ì‘ì„± ì‹œ

```
1. ì›¹ ì„œë²„ â”€â”€> Redis ìºì‹œ í™•ì¸
2. ì›¹ ì„œë²„ â”€â”€> Private Endpoint â”€â”€> MySQL (ê¸€ ì €ì¥)
3. MySQL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> Replica (ìë™ ë³µì œ)
4. ì›¹ ì„œë²„ â”€â”€> Redis (ìºì‹œ ì—…ë°ì´íŠ¸)
```

### 2ï¸âƒ£ ì‚¬ìš©ìê°€ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹œ

```
1. ì›¹ ì„œë²„ â”€â”€> Private Endpoint â”€â”€> Storage Account (íŒŒì¼ ì €ì¥)
2. Storage â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> CDN (ì „ ì„¸ê³„ ë°°í¬)
3. ì‚¬ìš©ì â”€â”€> CDN Edge ì„œë²„ (ë¹ ë¥¸ ë‹¤ìš´ë¡œë“œ)
```

### 3ï¸âƒ£ ë°ì´í„° ë¶„ì„ ì‹œ

```
1. Data Factory â”€â”€> MySQL (ë°ì´í„° ì¶”ì¶œ)
2. Data Factory â”€â”€> ë°ì´í„° ê°€ê³µ/ë³€í™˜
3. Data Factory â”€â”€> Storage (ê²°ê³¼ ì €ì¥)
```

---

## ğŸ’¡ ì£¼ìš” íŠ¹ì§• ì •ë¦¬

| í•­ëª© | êµ¬ì„± | ëª©ì  |
|------|------|------|
| **ê³ ê°€ìš©ì„±** | Primary + Replica DB | ì¬í•´ ëŒ€ë¹„ |
| **ì„±ëŠ¥ í–¥ìƒ** | Redis Cache | ì‘ë‹µ ì†ë„ 10ë°° â†‘ |
| **ê¸€ë¡œë²Œ ë°°í¬** | Azure CDN | ì „ ì„¸ê³„ ë¹ ë¥¸ ì ‘ì† |
| **ë³´ì•ˆ ê°•í™”** | Private Endpoint | ì™¸ë¶€ ì°¨ë‹¨ |
| **ë¹„ìš© ì ˆê°** | Lifecycle Policy | ìë™ ì •ë¦¬ |
| **ë°ì´í„° ë¶„ì„** | Data Factory | ETL ì‘ì—… |

---

## ğŸ”§ ê´€ë¦¬ í¬ì¸íŠ¸

### ë°±ì—…
- **ìë™ ë°±ì—…**: ë§¤ì¼ ì‹¤í–‰, 35ì¼ ë³´ê´€
- **ì§€ì—­ ë³µì œ**: í•œêµ­ ë‚¨ë¶€ì— ì‹¤ì‹œê°„ ë³µì œ
- **ë³µêµ¬ ì‹œê°„**: ì¬í•´ ë°œìƒ ì‹œ 4ì‹œê°„ ì´ë‚´ ë³µêµ¬ ê°€ëŠ¥

### ëª¨ë‹ˆí„°ë§
- **CPU/ë©”ëª¨ë¦¬**: 80% ì´ˆê³¼ ì‹œ ì•Œë¦¼
- **ë””ìŠ¤í¬**: 90% ì´ˆê³¼ ì‹œ ìë™ í™•ì¥
- **ì—°ê²° ìˆ˜**: ì»¤ë„¥ì…˜ í’€ ê³¼ë‹¤ ì‚¬ìš© ê°ì§€

### ë¹„ìš© ìµœì í™”
- **Storage Lifecycle**: 30ì¼ í›„ Cool Tier ì´ë™
- **Redis**: í•„ìš” ì‹œì—ë§Œ Standard/Premium ì‚¬ìš©
- **CDN**: ìºì‹œ Hit Rate 90% ì´ìƒ ìœ ì§€

---

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- [MySQL Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/mysql_flexible_server)
- [Storage Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/storage_account)
- [Redis Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/redis_cache)
- [CDN Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/cdn_profile)
- [Data Factory Terraform](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_factory)

---

**ì‘ì„±ì¼**: 2025-11-20  
**ë²„ì „**: 1.0 (DB/Storage ì§‘ì¤‘ ê°„ì†Œí™”)
